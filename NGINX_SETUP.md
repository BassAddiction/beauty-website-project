# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx —Å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:

1. ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø–æ–ª—É—á–µ–Ω—ã –¥–ª—è:
   - `speedvpn.shop`
   - `api.speedvpn.shop`

2. ‚úÖ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
3. ‚úÖ Docker Compose –æ–±–Ω–æ–≤–ª—ë–Ω

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –®–∞–≥ 1: –ó–∞–ø–æ–ª–Ω–∏—Ç–µ .env —Ñ–∞–π–ª

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã:

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
POSTGRES_DB=speedvpn_db
POSTGRES_USER=speedvpn_user
POSTGRES_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å

# Redis
REDIS_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å

# Telegram –±–æ—Ç
TELEGRAM_BOT_TOKEN=1234567890:ABC...
PAYMENT_PROVIDER_TOKEN=381764678:TEST:...

# –î—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏...
```

---

### –®–∞–≥ 2: –°–æ–±–µ—Ä–∏—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

–°–æ–±–µ—Ä–∏—Ç–µ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
npm install
npm run build
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫—É `dist/` —Å –≥–æ—Ç–æ–≤—ã–º —Å–∞–π—Ç–æ–º.

---

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
docker compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å—ë —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
docker compose up -d --build
```

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose ps

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã:
# - speedvpn-postgres
# - speedvpn-redis
# - speedvpn-backend
# - speedvpn-nginx
# - speedvpn-telegram-bot

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ nginx
docker compose logs nginx

# –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ SSL
```

---

## üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ **https://speedvpn.shop**
   - –î–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è –≤–∞—à —Å–∞–π—Ç
   - –ó–µ–ª—ë–Ω—ã–π –∑–∞–º–æ—á–µ–∫ üîí –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

2. –û—Ç–∫—Ä–æ–π—Ç–µ **https://api.speedvpn.shop/health**
   - –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: `healthy`

3. –û—Ç–∫—Ä–æ–π—Ç–µ **http://speedvpn.shop**
   - –î–æ–ª–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ HTTPS

---

## üîç –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

### –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç (speedvpn.shop):
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP ‚Üí HTTPS
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ—Ç Let's Encrypt
- ‚úÖ React Router –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (SPA)
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (JS, CSS, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (HSTS, X-Frame-Options, –∏ —Ç.–¥.)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ Rate limiting (30 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫)

### API (api.speedvpn.shop):
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP ‚Üí HTTPS
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ—Ç Let's Encrypt
- ‚úÖ –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ backend:3000
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Rate limiting (10 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ –¥–ª—è API)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (X-Real-IP, X-Forwarded-For)

---

## üõ† –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

### –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:

```bash
# 1. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
npm run build

# 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ nginx
docker compose restart nginx
```

### –û–±–Ω–æ–≤–∏—Ç—å backend:

```bash
# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose up -d --build backend
```

---

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –õ–æ–≥–∏ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose logs -f

# –õ–æ–≥–∏ —Ç–æ–ª—å–∫–æ nginx
docker compose logs -f nginx

# –õ–æ–≥–∏ backend
docker compose logs -f backend

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å nginx
docker compose restart nginx

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é nginx
docker compose exec nginx nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é nginx –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è
docker compose exec nginx nginx -s reload

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë
docker compose down

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å —É–¥–∞–ª–µ–Ω–∏–µ–º volumes (–ë–î –±—É–¥–µ—Ç –æ—á–∏—â–µ–Ω–∞!)
docker compose down -v
```

---

## üÜò –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### Nginx –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose logs nginx

# –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:
# "certificate file not found" - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–∞ –º–µ—Å—Ç–µ
ls -la /etc/letsencrypt/live/speedvpn.shop/
ls -la /etc/letsencrypt/live/api.speedvpn.shop/

# "bind() to 0.0.0.0:443 failed" - –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç
sudo lsof -i :443
```

### –°–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω
docker compose ps nginx

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã
sudo netstat -tlnp | grep :443
sudo netstat -tlnp | grep :80

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS
nslookup speedvpn.shop
nslookup api.speedvpn.shop

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª
sudo ufw status
```

### Backend –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω
docker compose ps backend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health endpoint
docker compose exec nginx curl http://backend:3000/health

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose logs backend
```

### SSL –æ—à–∏–±–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
sudo certbot certificates

# –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤—Ä—É—á–Ω—É—é
sudo certbot renew

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ nginx –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
docker compose restart nginx
```

---

## üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL

Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏–ª cron job –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
```bash
sudo systemctl status certbot.timer
```

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
```bash
sudo certbot renew
docker compose restart nginx
```

---

## üéØ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—Å–ª–∏:
- ‚úÖ https://speedvpn.shop –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –∑–µ–ª—ë–Ω—ã–º –∑–∞–º–æ—á–∫–æ–º
- ‚úÖ https://api.speedvpn.shop/health –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "healthy"
- ‚úÖ http://speedvpn.shop –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ HTTPS
- ‚úÖ –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Å—Ç–∞—Ç—É—Å–µ "Up"
- ‚úÖ –õ–æ–≥–∏ nginx –±–µ–∑ –æ—à–∏–±–æ–∫ SSL

**–ì–æ—Ç–æ–≤–æ! üöÄ –í–∞—à VPN —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å SSL!**
