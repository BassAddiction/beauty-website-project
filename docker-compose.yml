# ============================================
# SPEED VPN - DOCKER COMPOSE –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
# ============================================
# 
# –≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–æ–µ–∫—Ç–∞:
# - postgres: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
# - redis: –ö–µ—à –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Å—Å–∏–π
# - backend: API —Å–µ—Ä–≤–µ—Ä (Node.js + Python —Ñ—É–Ω–∫—Ü–∏–∏)
# - nginx: –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ reverse proxy
# - adminer: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# 
# –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ—Ä—É—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ .env
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ .env.example –≤ .env –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–≤–æ–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

version: '3.8'

services:
  # ==========================================
  # POSTGRESQL - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
  # ==========================================
  # –•—Ä–∞–Ω–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø–æ–¥–ø–∏—Å–∫–∏, –ø–ª–∞—Ç–µ–∂–∏, –ª–æ–≥–∏
  # –ü–æ—Ä—Ç 5432 –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑–≤–Ω–µ (–º–æ–∂–µ—Ç–µ –∑–∞–∫—Ä—ã—Ç—å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
  
  postgres:
    image: postgres:14-alpine
    container_name: speedvpn-postgres
    restart: unless-stopped
    environment:
      # –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–∏–∑ .env –∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é speedvpn_db)
      POSTGRES_DB: ${POSTGRES_DB:-speedvpn_db}
      
      # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î (–∏–∑ .env –∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é speedvpn_user)
      POSTGRES_USER: ${POSTGRES_USER:-speedvpn_user}
      
      # ‚ö†Ô∏è –í–ê–ñ–ù–û: –ü–∞—Ä–æ–ª—å –±–µ—Ä–µ—Ç—Å—è –∏–∑ .env —Ñ–∞–π–ª–∞!
      # –ï—Å–ª–∏ .env –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è "changeme" (–ù–ï –ë–ï–ó–û–ü–ê–°–ù–û –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞!)
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-changeme}
      
      # –ö–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8 –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
      POSTGRES_INITDB_ARGS: "--encoding=UTF8 --locale=C"
    volumes:
      # –î–∞–Ω–Ω—ã–µ –ë–î —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Docker volume (–Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ)
      - postgres_data:/var/lib/postgresql/data
      
      # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
      - ./db_migrations:/docker-entrypoint-initdb.d:ro
    ports:
      # –ü–æ—Ä—Ç 5432 –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Ö–æ—Å—Ç–µ (–º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
      - "5432:5432"
    networks:
      - speedvpn-network
    healthcheck:
      # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –ë–î –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—å –∏ –≥–æ—Ç–æ–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
      test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER:-speedvpn_user}"]
      interval: 10s
      timeout: 5s
      retries: 5

  # ==========================================
  # REDIS - –ö–µ—à –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Å—Å–∏–π
  # ==========================================
  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  # –ü–æ—Ä—Ç 6379 –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑–≤–Ω–µ (–º–æ–∂–µ—Ç–µ –∑–∞–∫—Ä—ã—Ç—å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
  
  redis:
    image: redis:7-alpine
    container_name: speedvpn-redis
    restart: unless-stopped
    
    # ‚ö†Ô∏è –í–ê–ñ–ù–û: –ü–∞—Ä–æ–ª—å –±–µ—Ä–µ—Ç—Å—è –∏–∑ .env —Ñ–∞–π–ª–∞!
    # –ö–æ–º–∞–Ω–¥–∞: redis-server —Å –ø–∞—Ä–æ–ª–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∏—Å–∫
    command: redis-server --appendonly yes --requirepass ${REDIS_PASSWORD:-changeme}
    volumes:
      # –î–∞–Ω–Ω—ã–µ Redis —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Docker volume
      - redis_data:/data
    ports:
      # –ü–æ—Ä—Ç 6379 –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Ö–æ—Å—Ç–µ (–º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
      - "6379:6379"
    networks:
      - speedvpn-network
    healthcheck:
      # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ Redis —Ä–∞–±–æ—Ç–∞–µ—Ç
      test: ["CMD", "redis-cli", "--raw", "incr", "ping"]
      interval: 30s
      timeout: 10s
      retries: 3

  # ==========================================
  # BACKEND - API –°–µ—Ä–≤–µ—Ä
  # ==========================================
  # Node.js —Å–µ—Ä–≤–µ—Ä –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ Python —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ /backend
  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –æ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
  # –ò–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ë–î, Redis –∏ –≤—Å–µ–º —Å–µ–∫—Ä–µ—Ç–∞–º –∏–∑ .env
  
  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend
    container_name: speedvpn-backend
    restart: unless-stopped
    
    # –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ backend
    env_file:
      - .env
    environment:
      NODE_ENV: production
      
      # DATABASE_URL —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ postgres –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
      DATABASE_URL: postgresql://${POSTGRES_USER:-speedvpn_user}:${POSTGRES_PASSWORD:-changeme}@postgres:5432/${POSTGRES_DB:-speedvpn_db}
    volumes:
      # Backend —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è read-only (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
      - ./backend:/app/backend:ro
      
      # –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ volume
      - backend_logs:/var/log/backend
    ports:
      # API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000
      - "3000:3000"
    depends_on:
      # Backend –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ postgres –±—É–¥–µ—Ç –∑–¥–æ—Ä–æ–≤
      postgres:
        condition: service_healthy
    networks:
      - speedvpn-network
    healthcheck:
      # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ backend –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ /health endpoint
      test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
      interval: 30s
      timeout: 10s
      retries: 3

  # ==========================================
  # NGINX - –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ Reverse Proxy
  # ==========================================
  # –û—Ç–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (HTML, JS, CSS)
  # –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç API –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ backend
  # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è HTTPS
  
  nginx:
    image: nginx:alpine
    container_name: speedvpn-nginx
    restart: unless-stopped
    ports:
      # HTTP –ø–æ—Ä—Ç (80)
      - "80:80"
      
      # HTTPS –ø–æ—Ä—Ç (443) - –¥–ª—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
      - "443:443"
    volumes:
      # –°–æ–±—Ä–∞–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç npm run build)
      - ./dist:/usr/share/nginx/html:ro
      
      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx (–Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞)
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      
      # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (–ø–æ–ª–æ–∂–∏—Ç–µ —Å—é–¥–∞ .crt –∏ .key —Ñ–∞–π–ª—ã)
      - ./nginx/ssl:/etc/nginx/ssl:ro
      
      # –õ–æ–≥–∏ nginx —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ volume
      - nginx_logs:/var/log/nginx
    depends_on:
      # Nginx –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø–æ—Å–ª–µ backend
      - backend
    networks:
      - speedvpn-network
    healthcheck:
      # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ nginx –æ—Ç–≤–µ—á–∞–µ—Ç
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost/health"]
      interval: 30s
      timeout: 10s
      retries: 3

  # ==========================================
  # ADMINER - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î
  # ==========================================
  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PostgreSQL —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
  # –î–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8080
  # 
  # –ó–∞–ø—É—Å–∫ adminer: docker compose --profile debug up -d
  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞: docker compose --profile debug down
  
  adminer:
    image: adminer:latest
    container_name: speedvpn-adminer
    restart: unless-stopped
    ports:
      # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ –ø–æ—Ä—Ç—É 8080
      - "8080:8080"
    environment:
      # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ postgres –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
      ADMINER_DEFAULT_SERVER: postgres
    depends_on:
      - postgres
    networks:
      - speedvpn-network
    profiles:
      # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å —Ñ–ª–∞–≥–æ–º --profile debug
      # –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —á—Ç–æ–±—ã –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
      - debug

  # ==========================================
  # TELEGRAM BOT - –ë–æ—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –ø–æ–¥–ø–∏—Å–æ–∫
  # ==========================================
  # Telegram –±–æ—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ VPN –ø–æ–¥–ø–∏—Å–æ–∫
  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ –ë–î —á—Ç–æ –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç
  
  telegram-bot:
    build:
      context: ./telegram-bot
      dockerfile: Dockerfile
    container_name: speedvpn-telegram-bot
    restart: unless-stopped
    env_file:
      - .env
    environment:
      # DATABASE_URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ postgres
      DATABASE_URL: postgresql://${POSTGRES_USER:-speedvpn_user}:${POSTGRES_PASSWORD:-changeme}@postgres:5432/${POSTGRES_DB:-speedvpn_db}
      
      # TELEGRAM_BOT_TOKEN –±–µ—Ä–µ—Ç—Å—è –∏–∑ .env —Ñ–∞–π–ª–∞
      TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN}
      
      # PAYMENT_PROVIDER_TOKEN –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π
      PAYMENT_PROVIDER_TOKEN: ${PAYMENT_PROVIDER_TOKEN}
    depends_on:
      postgres:
        condition: service_healthy
    networks:
      - speedvpn-network

# ============================================
# VOLUMES - –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
# ============================================
# Docker volumes —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –¥–∞–Ω–Ω—ã–µ –¥–∞–∂–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
# –î–∞–Ω–Ω—ã–µ –ù–ï —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ `docker compose down`
# –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è: docker compose down -v

volumes:
  # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL (—Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã, –¥–∞–Ω–Ω—ã–µ)
  postgres_data:
    driver: local
  
  # –î–∞–Ω–Ω—ã–µ Redis (–∫–µ—à, —Å–µ—Å—Å–∏–∏)
  redis_data:
    driver: local
  
  # –õ–æ–≥–∏ Nginx (access.log, error.log)
  nginx_logs:
    driver: local
  
  # –õ–æ–≥–∏ Backend (application logs)
  backend_logs:
    driver: local

# ============================================
# NETWORKS - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å Docker
# ============================================
# –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —ç—Ç—É —Å–µ—Ç—å
# –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∞–º:
# - postgres –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∏–º–µ–Ω–∏ "postgres"
# - backend –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∏–º–µ–Ω–∏ "backend"
# - redis –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∏–º–µ–Ω–∏ "redis"

networks:
  speedvpn-network:
    driver: bridge


# ============================================
# üöÄ –ö–û–ú–ê–ù–î–´ –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø
# ============================================
# 
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
#   docker compose up -d
# 
# –ó–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π:
#   docker compose up -d --build
# 
# –ó–∞–ø—É—Å–∫ —Å adminer (–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î):
#   docker compose --profile debug up -d
# 
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
#   docker compose down
# 
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º volumes (‚ö†Ô∏è –£–î–ê–õ–ò–¢ –í–°–ï –î–ê–ù–ù–´–ï!):
#   docker compose down -v
# 
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞:
#   docker compose ps
# 
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
#   docker compose logs
# 
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
#   docker compose logs backend
#   docker compose logs postgres
#   docker compose logs nginx
# 
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
#   docker compose logs -f
# 
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
#   docker compose restart backend
# 
# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:
#   docker compose exec backend sh
#   docker compose exec postgres psql -U speedvpn_user -d speedvpn_db
# 
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
#   docker compose ps
#   (—Å—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "healthy" –¥–ª—è postgres, backend, nginx)


# ============================================
# üîß –ù–ê–°–¢–†–û–ô–ö–ê –ü–ï–†–ï–ú–ï–ù–ù–´–• –û–ö–†–£–ñ–ï–ù–ò–Ø
# ============================================
# 
# 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª —Å –ø—Ä–∏–º–µ—Ä–æ–º:
#    cp .env.example .env
# 
# 2. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
#    nano .env
# 
# 3. –ó–∞–º–µ–Ω–∏—Ç–µ –≤—Å–µ "paste_your_..." –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
# 
# 4. –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏–∑–º–µ–Ω–∏—Ç–µ:
#    - POSTGRES_PASSWORD (–ø–∞—Ä–æ–ª—å –ë–î)
#    - DATABASE_URL (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ –ø–∞—Ä–æ–ª—å)
#    - REDIS_PASSWORD (–ø–∞—Ä–æ–ª—å Redis)
#    - ADMIN_PASSWORD (–ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∫–∏)
#    - REMNAWAVE_API_TOKEN (—Ç–æ–∫–µ–Ω VPN –ø–∞–Ω–µ–ª–∏)
#    - REMNAWAVE_API_URL (URL VPN –ø–∞–Ω–µ–ª–∏)
#    - USER_SQUAD_UUIDS (UUID —Å–∫–≤–∞–¥–æ–≤)
# 
# 5. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞):
#    - RESEND_API_KEY (email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
#    - YOOKASSA_SHOP_ID –∏ YOOKASSA_SECRET_KEY (–ø–ª–∞—Ç–µ–∂–∏)
# 
# 6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
#    docker compose up -d --build


# ============================================
# üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨
# ============================================
# 
# –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
# 
# 1. –ó–∞–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã –ë–î –∏ Redis (—É–¥–∞–ª–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ ports –¥–ª—è postgres –∏ redis)
# 
# 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–¥–µ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ (–º–∏–Ω–∏–º—É–º 16 —Å–∏–º–≤–æ–ª–æ–≤)
# 
# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall:
#    ufw allow 80/tcp
#    ufw allow 443/tcp
#    ufw deny 5432/tcp  # –∑–∞–∫—Ä—ã—Ç—å PostgreSQL
#    ufw deny 6379/tcp  # –∑–∞–∫—Ä—ã—Ç—å Redis
#    ufw enable
# 
# 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è HTTPS (–ø–æ–ª–æ–∂–∏—Ç–µ –≤ ./nginx/ssl/)
# 
# 5. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å Docker –æ–±—Ä–∞–∑—ã:
#    docker compose pull
#    docker compose up -d --build
# 
# 6. –î–µ–ª–∞—Ç—å –±—ç–∫–∞–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
#    docker compose exec postgres pg_dump -U speedvpn_user speedvpn_db > backup.sql
# 
# 7. –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å adminer –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (profiles: debug)


# ============================================
# üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì
# ============================================
# 
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:
#   docker stats
# 
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞:
#   docker system df
# 
# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
#   docker system prune -a
# 
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π:
#   docker compose logs backend | grep ERROR
#   docker compose logs postgres | grep ERROR